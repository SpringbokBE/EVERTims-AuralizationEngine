#include "LedComponent.h"

///////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////

LedComponent::LedComponent()
{
	isClipped = false;
	startTimer(timerUpdateIntervalInMs);
}

///////////////////////////////////////////////////////////////////////////////////////////////////

void LedComponent::paint(Graphics& g)
// Paint callback associated to this component, draw source image, user head, etc.
{
	g.setColour(Colours::dimgrey);
	g.drawEllipse(3.0, 7.0, 8.0, 8.0, 2.0);

	// draw led if currently clipped
	if (isClipped)
	{
		g.setColour(Colours::red);
		// update next unclip time
		nextUnclipTime = Time::getMillisecondCounter() + ledFadeDuration;
	}
	else
	{
		// check if time to switch off led reached
		if (Time::getMillisecondCounter() >= nextUnclipTime)
		{
			// reset clip state
			isClipped = false;
		}
	}

	g.fillEllipse(3.7, 7.6, 7.0, 7.0);
}

///////////////////////////////////////////////////////////////////////////////////////////////////

void LedComponent::timerCallback()
// get owner clip state
{
	repaint();
}

///////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////